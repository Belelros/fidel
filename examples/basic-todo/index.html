<html>
  <head>
    <title></title>
  </head>
  <style>
    body {
      background: #f0f0f0;
    }
    #app {
      background: #fff;
      border: 1px solid #ccc;
      width: 500px;
      margin: 0 auto;
    }
    #templates { display: none; }
  </style>
  <body>
    <div id="app">
      <div id="taskList"></div>
      <div id="taskDetails"></div>
    </div>

    <div id="templates">

      <div data-template="taskList">
        <header>
          <h1>Tasks</h1>
          <button>Add Task</button>
        </header> 
        <ul>
        </ul>
      </div>

      <div data-template="taskDetails">
        <input type="text" placeholder="Task Name"/>
        <button>Add</button>
      </div>
    </div>

    <script src="../../support/jquery.min.js"></script>
    <script src="../../lib/view.js"></script>
    <script src="../../lib/jquery.view.js"></script>
    <script>

      var taskListView = {
        events: {
          'click button': 'addTask'
        },
        templateName: 'taskList',
        init: function() {
        },
        addTask: function() {
          this.emit('addTask');
        },
        setTasks: function(tasks) {
          this.tasks = tasks;
        },
        render: function() {
          View.prototype.render.call(this);
          var html = [];
          for (var i = 0, c = this.tasks.length; i < c; i++) {
            var li = '<li><input type="checkbox"/>'+this.tasks[i]+'</li>';
            html.push(li);
          }
          this.find('ul').html(html.join(''));
        }
      }

      var taskDetailsView = {
        templateName: 'taskDetails',
        events: {
          'click button': 'submit'
        },
        elements: {
          'input': 'textField'
        },
        init: function() {
        },
        setTaskName: function(taskName) {

        },
        submit: function() {
          var val = this.textField.val();
          this.textField.val('');
          this.emit('newTask', val);
        }
      };

      var appView = {
        views: {
          'taskList': { target: '#taskList', view: taskListView },
          'taskDetails': { target: '#taskDetails', view: taskDetailsView }
        },
        subs: {
          'taskList addTask': 'viewTaskDetails',
          'taskDetails newTask': 'newTask'
        },
        init: function() {
          this.tasks = ['task 1', 'task2'];
          this.taskList.setTasks(this.tasks);
          this.taskList.render();
        },
        viewTaskDetails: function() {
          this.taskList.hide();
          this.taskDetails.render();
          this.taskDetails.show();
        },
        newTask: function(e, taskName) {
          this.taskDetails.hide();
          this.tasks.push(taskName);
          this.taskList.render();
          this.taskList.show();
        }
      };

      $("#app").view(appView);
    </script>
  </body>
</html>
