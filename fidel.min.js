/*!
  * Fidel - A javascript controller
  * v1.2
  * https://github.com/jgallen23/fidel
  * copyright JGA 2011
  * MIT License
  */
!function(a){var b={};b.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=Math.random()*16|0,c=a==="x"?b:b&3|8;return c.toString(16)}).toUpperCase()},b.extend=function(){throw new Error("Fidel.extend is deprecated, please use Fidel.ViewController.extend")};var c=a.Fidel;b.noConflict=function(){a.Fidel=c;return this},a.Fidel=b}(this),!function(a){var b=!1,c=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;a.Class=function(){},a.Class.extend=function(d){function i(){b||(this.guid=a.guid(),this._initialize&&this._initialize.apply(this,arguments),this.init&&this.init.apply(this,arguments))}var e=this.prototype;b=!0;var g=new this;b=!1;for(var h in d)g[h]=typeof d[h]=="function"&&typeof e[h]=="function"&&c.test(d[h])?function(a,b){return function(){var c=this._super;this._super=e[a];var d=b.apply(this,arguments);this._super=c;return d}}(h,d[h]):d[h];i.prototype=g,i.prototype.proxy=function(a){var b=this;return function(){if(!!a)return a.apply(b,arguments)}},i.constructor=i,i.extend=arguments.callee;return i}}(Fidel||this),!function(a){var b={};a.publish=function(a,c){var d=b[a],e=d?d.length:0;while(e--)d[e].apply(this,c||[])},a.subscribe=function(a,c){b[a]||(b[a]=[]),b[a].push(c);return[a,c]},a.unsubscribe=function(a){var c=b[a[0]],d=a[1],e=c?c.length:0;while(e--)c[e]===d&&c.splice(e,1)},a.Class.prototype.on=a.Class.prototype.bind=function(b,c){return a.subscribe(this.guid+"."+b,this.proxy(c))},a.Class.prototype.emit=a.Class.prototype.trigger=function(b,c){a.publish(this.guid+"."+b,c),a.publish(b,c)},a.Class.prototype.removeListener=a.Class.prototype.unbind=function(b){a.unsubscribe(b)}}(Fidel||this),function(a){var b=/^(\w+)\s*(.*)$/,c=a.Class.extend({_initialize:function(a){for(var b in a)this[b]=a[b];if(!this.el)throw"el is required";this._subscribeHandles={},this._processedActions={},this.events&&this.delegateEvents(),this.elements&&this.refreshElements(),this.templateSelector&&this.loadTemplate(),this.actionEvent||(this.actionEvent="click"),this.subscribe&&this.bindSubscriptions(),this.delegateActions(),this.getDataElements()},delegateEvents:function(){for(var a in this.events){var c=this.events[a],d=a.match(b),e=d[1],f=d[2],g=this.proxy(this[c]);f===""?this.el.bind(e,g):this.el.delegate(f,e,g)}},delegateActions:function(){var a=this.find("[data-action]");for(var b=0,c=a.length;b<c;b++){var d=$(a[b]),e=d.attr("data-action"),f=this.proxy(this[e]),g=this.actionEvent,h='[data-action="'+e+'"]';this._processedActions[e]||(this.el.delegate(h,g,f),this._processedActions[e]=!0)}},refreshElements:function(){for(var a in this.elements)this[a]=this.find(this.elements[a])},getDataElements:function(){var a=this,b=this.find("[data-element]");for(var c=0,d=b.length;c<d;c++){var e=$(b[c]);a[e.attr("data-element")]=e}},bindSubscriptions:function(){for(var a in this.subscribe)this._subscribeHandles[a]=Fidel.subscribe(a,this.proxy(this[this.subscribe[a]]))},loadTemplate:function(){this.template=$(this.templateSelector).html()},find:function(a){return $(a,this.el[0])},render:function(a,b){var c=window.str||$;if(c){var d=c.template(this.template,a);b=b?$(b):this.el,b.html(d)}},destroy:function(){for(var a in this._subscribeHandles)Fidel.unsubscribe(this._subscribeHandles[a]);for(var b in this._processedActions)this.el.unbind(b);this.el=null}});a.ViewController=c}(Fidel||this)